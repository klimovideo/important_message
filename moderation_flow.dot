digraph ModerationFlow {
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥—Ä–∞—Ñ–∞
    rankdir=TB;
    node [shape=box, style=filled, fontname="Arial", fontsize=10];
    edge [fontname="Arial", fontsize=9];
    
    // –ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
    subgraph cluster_start {
        label="üöÄ –ù–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏";
        style=filled;
        color=lightblue;
        
        user_submit [label="üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å\n–ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ—Å—Ç", fillcolor=lightgreen];
        auto_detect [label="ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ\n–æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –≤–∞–∂–Ω–æ–≥–æ", fillcolor=lightgreen];
        forwarded_message [label="üì§ –ü–µ—Ä–µ—Å–ª–∞–Ω–Ω–æ–µ\n—Å–æ–æ–±—â–µ–Ω–∏–µ", fillcolor=lightgreen];
    }
    
    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞
    subgraph cluster_post_creation {
        label="üìù –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞";
        style=filled;
        color=lightgreen;
        
        create_post [label="üìã –°–æ–∑–¥–∞–Ω–∏–µ\n–æ–±—ä–µ–∫—Ç–∞ –ø–æ—Å—Ç–∞", fillcolor=lightyellow];
        generate_id [label="üÜî –ì–µ–Ω–µ—Ä–∞—Ü–∏—è\n—É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ ID", fillcolor=lightyellow];
        save_post [label="üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ\n–≤ –æ—á–µ—Ä–µ–¥—å", fillcolor=lightyellow];
        ai_evaluation [label="üß† AI –æ—Ü–µ–Ω–∫–∞\n–≤–∞–∂–Ω–æ—Å—Ç–∏", fillcolor=lightyellow];
    }
    
    // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
    subgraph cluster_notifications {
        label="üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤";
        style=filled;
        color=lightyellow;
        
        notify_admins [label="üì¢ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ\n–≤—Å–µ—Ö –∞–¥–º–∏–Ω–æ–≤", fillcolor=lightcoral];
        inline_buttons [label="üîò Inline –∫–Ω–æ–ø–∫–∏\n–º–æ–¥–µ—Ä–∞—Ü–∏–∏", fillcolor=lightcoral];
        post_preview [label="üëÄ –ü—Ä–µ–≤—å—é\n–ø–æ—Å—Ç–∞", fillcolor=lightcoral];
    }
    
    // –ü—Ä–æ—Ü–µ—Å—Å –º–æ–¥–µ—Ä–∞—Ü–∏–∏
    subgraph cluster_moderation {
        label="üëë –ü—Ä–æ—Ü–µ—Å—Å –º–æ–¥–µ—Ä–∞—Ü–∏–∏";
        style=filled;
        color=lightpink;
        
        admin_review [label="üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä\n—Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç", fillcolor=lightgreen];
        approve_action [label="‚úÖ –î–µ–π—Å—Ç–≤–∏–µ:\n–û–¥–æ–±—Ä–∏—Ç—å", fillcolor=lightgreen];
        reject_action [label="‚ùå –î–µ–π—Å—Ç–≤–∏–µ:\n–û—Ç–∫–ª–æ–Ω–∏—Ç—å", fillcolor=lightgreen];
        full_text_action [label="üìÑ –î–µ–π—Å—Ç–≤–∏–µ:\n–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç", fillcolor=lightgreen];
    }
    
    // –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ—Ä–∞—Ü–∏–∏
    subgraph cluster_results {
        label="üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –º–æ–¥–µ—Ä–∞—Ü–∏–∏";
        style=filled;
        color=lightblue;
        
        auto_publish [label="üöÄ –ê–≤—Ç–æ–ø—É–±–ª–∏–∫–∞—Ü–∏—è\n(–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞)", fillcolor=lightgreen];
        manual_publish [label="üìù –†—É—á–Ω–∞—è\n–ø—É–±–ª–∏–∫–∞—Ü–∏—è", fillcolor=lightgreen];
        publish_channel [label="üì¢ –ü—É–±–ª–∏–∫–∞—Ü–∏—è\n–≤ –∫–∞–Ω–∞–ª–µ", fillcolor=lightcoral];
        notify_author [label="üì± –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ\n–∞–≤—Ç–æ—Ä—É", fillcolor=lightgreen];
        update_status [label="üìä –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ\n—Å—Ç–∞—Ç—É—Å–∞", fillcolor=lightyellow];
    }
    
    // –•—Ä–∞–Ω–∏–ª–∏—â–∞
    subgraph cluster_storage {
        label="üíæ –•—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö";
        style=filled;
        color=lightgrey;
        
        pending_posts [label="üìù pending_posts.json\n(–æ—á–µ—Ä–µ–¥—å –º–æ–¥–µ—Ä–∞—Ü–∏–∏)", fillcolor=orange];
        bot_config [label="ü§ñ bot_config.json\n(–Ω–∞—Å—Ç—Ä–æ–π–∫–∏)", fillcolor=orange];
        user_prefs [label="üë• user_preferences.json\n(–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)", fillcolor=orange];
    }
    
    // –°–≤—è–∑–∏ –Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞
    user_submit -> create_post;
    auto_detect -> create_post;
    forwarded_message -> create_post;
    
    // –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–∞
    create_post -> generate_id;
    generate_id -> save_post;
    save_post -> ai_evaluation;
    ai_evaluation -> notify_admins;
    
    // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    notify_admins -> inline_buttons;
    inline_buttons -> post_preview;
    post_preview -> admin_review;
    
    // –ú–æ–¥–µ—Ä–∞—Ü–∏—è
    admin_review -> approve_action [label="–ù–∞–∂–∞—Ç–∏–µ\n‚úÖ –û–¥–æ–±—Ä–∏—Ç—å"];
    admin_review -> reject_action [label="–ù–∞–∂–∞—Ç–∏–µ\n‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å"];
    admin_review -> full_text_action [label="–ù–∞–∂–∞—Ç–∏–µ\nüìÑ –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç"];
    
    full_text_action -> admin_review [label="–í–æ–∑–≤—Ä–∞—Ç\n–∫ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—é"];
    
    // –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–¥–æ–±—Ä–µ–Ω–∏—è
    approve_action -> auto_publish [label="–ê–≤—Ç–æ–ø—É–±–ª–∏–∫–∞—Ü–∏—è\n–≤–∫–ª—é—á–µ–Ω–∞"];
    approve_action -> manual_publish [label="–†—É—á–Ω–∞—è\n–ø—É–±–ª–∏–∫–∞—Ü–∏—è"];
    
    auto_publish -> publish_channel;
    manual_publish -> publish_channel;
    
    // –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
    reject_action -> notify_author;
    
    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤
    approve_action -> update_status;
    reject_action -> update_status;
    publish_channel -> update_status;
    
    // –°–≤—è–∑–∏ —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º–∏
    save_post -> pending_posts;
    update_status -> pending_posts;
    ai_evaluation -> bot_config [label="–ß—Ç–µ–Ω–∏–µ\n–ø–æ—Ä–æ–≥–∞ –≤–∞–∂–Ω–æ—Å—Ç–∏"];
    notify_author -> user_prefs [label="–ß—Ç–µ–Ω–∏–µ\n–Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"];
    
    // –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è inline –∫–Ω–æ–ø–æ–∫
    subgraph cluster_inline_buttons {
        label="üîò Inline –∫–Ω–æ–ø–∫–∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏";
        style=filled;
        color=lightyellow;
        
        approve_button [label="‚úÖ –û–¥–æ–±—Ä–∏—Ç—å\ncallback: approve_post_{id}", fillcolor=lightgreen];
        reject_button [label="‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å\ncallback: reject_post_{id}", fillcolor=lightcoral];
        full_text_button [label="üìÑ –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç\ncallback: full_text_{id}", fillcolor=lightblue];
    }
    
    inline_buttons -> approve_button;
    inline_buttons -> reject_button;
    inline_buttons -> full_text_button;
    
    // –ü—Ä–∏–º–µ—Ä—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
    subgraph cluster_examples {
        label="üìã –ü—Ä–∏–º–µ—Ä—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π";
        style=filled;
        color=lightpink;
        
        admin_notification [label="üìù –ù–æ–≤—ã–π –ø–æ—Å—Ç –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏\n\nID: abc12345\n–û—Ç: @user_name\n–û—Ü–µ–Ω–∫–∞ –ò–ò: 0.85\n\n[‚úÖ –û–¥–æ–±—Ä–∏—Ç—å] [‚ùå –û—Ç–∫–ª–æ–Ω–∏—Ç—å] [üìÑ –ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç]", fillcolor=lightyellow];
        user_notification [label="‚úÖ –í–∞—à –ø–æ—Å—Ç –æ–¥–æ–±—Ä–µ–Ω –∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω!\n\nID: abc12345\n–í—Ä–µ–º—è: 15.03.2024 14:30", fillcolor=lightgreen];
    }
    
    notify_admins -> admin_notification;
    notify_author -> user_notification;
    
    // –°—Ç–∏–ª–∏ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
    edge [color=blue, penwidth=2];
    user_submit -> create_post;
    admin_review -> approve_action;
    approve_action -> auto_publish;
    
    edge [color=green, penwidth=1];
    approve_action -> manual_publish;
    auto_publish -> publish_channel;
    manual_publish -> publish_channel;
    
    edge [color=red, penwidth=1];
    admin_review -> reject_action;
    reject_action -> notify_author;
    
    edge [color=orange, penwidth=1];
    save_post -> pending_posts;
    update_status -> pending_posts;
    
    // –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —É—Ä–æ–≤–Ω—è–º
    {rank=same; user_submit; auto_detect; forwarded_message}
    {rank=same; create_post; generate_id; save_post}
    {rank=same; approve_button; reject_button; full_text_button}
    {rank=same; auto_publish; manual_publish; notify_author}
} 