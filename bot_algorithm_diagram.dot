digraph BotAlgorithm {
    // ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ Ğ³Ñ€Ğ°Ñ„Ğ°
    rankdir=TB;
    node [shape=box, style=filled, fontname="Arial", fontsize=10];
    edge [fontname="Arial", fontsize=9];
    
    // Ğ¦Ğ²ĞµÑ‚Ğ¾Ğ²Ğ°Ñ ÑÑ…ĞµĞ¼Ğ°
    subgraph cluster_legend {
        label="Ğ›ĞµĞ³ĞµĞ½Ğ´Ğ°";
        style=filled;
        color=lightgrey;
        
        start [label="ĞĞ°Ñ‡Ğ°Ğ»Ğ¾/ĞšĞ¾Ğ½ĞµÑ†", shape=ellipse, fillcolor=lightblue];
        process [label="ĞŸÑ€Ğ¾Ñ†ĞµÑÑ", fillcolor=lightgreen];
        decision [label="Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ", shape=diamond, fillcolor=yellow];
        storage [label="Ğ¥Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğµ", shape=cylinder, fillcolor=orange];
        external [label="Ğ’Ğ½ĞµÑˆĞ½Ğ¸Ğ¹ ÑĞµÑ€Ğ²Ğ¸Ñ", shape=box, fillcolor=lightcoral];
        user [label="ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ", shape=box, fillcolor=lightpink];
    }
    
    // ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ñ‹ ÑĞ¸ÑÑ‚ĞµĞ¼Ñ‹
    subgraph cluster_system {
        label="Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ° Ğ²Ğ°Ğ¶Ğ½Ñ‹Ñ… ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹";
        style=filled;
        color=lightblue;
        
        // ĞĞ°Ñ‡Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ‚Ğ¾Ñ‡ĞºĞ¸
        start_bot [label="ğŸš€ Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ±Ğ¾Ñ‚Ğ°", shape=ellipse, fillcolor=lightblue];
        user_start [label="ğŸ‘¤ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ\nĞ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ĞµÑ‚ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñƒ", shape=ellipse, fillcolor=lightblue];
        
        // Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ
        init_storage [label="ğŸ“ Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ\nÑ…Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…", fillcolor=lightgreen];
        load_config [label="âš™ï¸ Ğ—Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ°\nĞºĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ğ¸", fillcolor=lightgreen];
        setup_handlers [label="ğŸ”§ ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°\nĞ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸ĞºĞ¾Ğ²", fillcolor=lightgreen];
        
        // Ğ¥Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğ°
        user_prefs [label="ğŸ‘¥ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¸Ğµ\nĞ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸", shape=cylinder, fillcolor=orange];
        bot_config [label="ğŸ¤– ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ\nĞ±Ğ¾Ñ‚Ğ°", shape=cylinder, fillcolor=orange];
        pending_posts [label="ğŸ“ ĞÑ‡ĞµÑ€ĞµĞ´ÑŒ Ğ¿Ğ¾ÑÑ‚Ğ¾Ğ²\nĞ½Ğ° Ğ¼Ğ¾Ğ´ĞµÑ€Ğ°Ñ†Ğ¸Ñ", shape=cylinder, fillcolor=orange];
        
        // ĞÑĞ½Ğ¾Ğ²Ğ½Ñ‹Ğµ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑÑ‹
        check_user_type [label="ğŸ” ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ\nÑ‚Ğ¸Ğ¿Ğ° Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ", shape=diamond, fillcolor=yellow];
        
        // ĞĞ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€
        admin_menu [label="ğŸ‘‘ ĞœĞµĞ½Ñ\nĞ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ°", fillcolor=lightgreen];
        admin_actions [label="âš¡ Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ\nĞ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ°", fillcolor=lightgreen];
        
        // ĞĞ±Ñ‹Ñ‡Ğ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ
        user_menu [label="ğŸ‘¤ ĞœĞµĞ½Ñ\nĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ", fillcolor=lightgreen];
        user_actions [label="ğŸ“ Ğ”ĞµĞ¹ÑÑ‚Ğ²Ğ¸Ñ\nĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ", fillcolor=lightgreen];
    }
    
    // ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
    subgraph cluster_monitoring {
        label="ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹";
        style=filled;
        color=lightgreen;
        
        // Ğ˜ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ¸ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
        passive_monitoring [label="ğŸ“¤ ĞŸĞ°ÑÑĞ¸Ğ²Ğ½Ñ‹Ğ¹ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³\n(Ğ¿ĞµÑ€ĞµÑĞ»Ğ°Ğ½Ğ½Ñ‹Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ)", fillcolor=lightgreen];
        active_monitoring [label="ğŸ¤– ĞĞºÑ‚Ğ¸Ğ²Ğ½Ñ‹Ğ¹ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³\n(Userbot)", fillcolor=lightgreen];
        
        // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹
        receive_message [label="ğŸ“¨ ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ\nÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ñ", fillcolor=lightgreen];
        extract_info [label="ğŸ” Ğ˜Ğ·Ğ²Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ\nĞ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸", fillcolor=lightgreen];
        check_source [label="âœ… ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°\nĞ¸ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸ĞºĞ°", shape=diamond, fillcolor=yellow];
        
        // AI Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·
        ai_analysis [label="ğŸ§  AI Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·\nĞ²Ğ°Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸", fillcolor=lightgreen];
        giga_chat [label="ğŸ¤– GigaChat API", shape=box, fillcolor=lightcoral];
        
        // ĞŸÑ€Ğ¸Ğ½ÑÑ‚Ğ¸Ğµ Ñ€ĞµÑˆĞµĞ½Ğ¸Ğ¹
        check_importance [label="â­ ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ°\nĞ²Ğ°Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸", shape=diamond, fillcolor=yellow];
        check_threshold [label="ğŸ“Š Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ\nÑ Ğ¿Ğ¾Ñ€Ğ¾Ğ³Ğ¾Ğ¼", shape=diamond, fillcolor=yellow];
    }
    
    // ĞœĞ¾Ğ´ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¸ Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ
    subgraph cluster_moderation {
        label="ĞœĞ¾Ğ´ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¸ Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ";
        style=filled;
        color=lightyellow;
        
        // ĞœĞ¾Ğ´ĞµÑ€Ğ°Ñ†Ğ¸Ñ
        inline_moderation [label="âš¡ Inline Ğ¼Ğ¾Ğ´ĞµÑ€Ğ°Ñ†Ğ¸Ñ\n(ĞºĞ½Ğ¾Ğ¿ĞºĞ¸)", fillcolor=lightgreen];
        admin_review [label="ğŸ‘‘ Ğ Ğ°ÑÑĞ¼Ğ¾Ñ‚Ñ€ĞµĞ½Ğ¸Ğµ\nĞ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ¾Ğ¼", fillcolor=lightgreen];
        
        // Ğ ĞµÑˆĞµĞ½Ğ¸Ñ Ğ¼Ğ¾Ğ´ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸
        approve_decision [label="âœ… ĞĞ´Ğ¾Ğ±Ñ€Ğ¸Ñ‚ÑŒ", shape=diamond, fillcolor=yellow];
        reject_decision [label="âŒ ĞÑ‚ĞºĞ»Ğ¾Ğ½Ğ¸Ñ‚ÑŒ", shape=diamond, fillcolor=yellow];
        
        // ĞŸÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ
        auto_publish [label="ğŸš€ ĞĞ²Ñ‚Ğ¾Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ", fillcolor=lightgreen];
        manual_publish [label="ğŸ“ Ğ ÑƒÑ‡Ğ½Ğ°Ñ\nĞ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ", fillcolor=lightgreen];
        publish_channel [label="ğŸ“¢ ĞšĞ°Ğ½Ğ°Ğ»\nĞ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ğ¸", shape=box, fillcolor=lightcoral];
        
        // Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ñ
        notify_user [label="ğŸ“± Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ\nĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ", fillcolor=lightgreen];
        notify_admins [label="ğŸ”” Ğ£Ğ²ĞµĞ´Ğ¾Ğ¼Ğ»ĞµĞ½Ğ¸Ğµ\nĞ°Ğ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€Ğ¾Ğ²", fillcolor=lightgreen];
    }
    
    // Userbot Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
    subgraph cluster_userbot {
        label="Userbot (ÑĞºÑ€Ñ‹Ñ‚Ñ‹Ğ¹ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³)";
        style=filled;
        color=lightpink;
        
        userbot_start [label="ğŸ¤– Ğ—Ğ°Ğ¿ÑƒÑĞº\nUserbot", fillcolor=lightgreen];
        userbot_join [label="â• ĞŸÑ€Ğ¸ÑĞ¾ĞµĞ´Ğ¸Ğ½ĞµĞ½Ğ¸Ğµ\nĞº ĞºĞ°Ğ½Ğ°Ğ»Ñƒ", fillcolor=lightgreen];
        userbot_monitor [label="ğŸ‘ï¸ ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³\nÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹", fillcolor=lightgreen];
        userbot_process [label="ğŸ”„ ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°\nÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğ¹", fillcolor=lightgreen];
    }
    
    // Ğ¡Ğ²ÑĞ·Ğ¸ Ğ¼ĞµĞ¶Ğ´Ñƒ ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ½ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸
    start_bot -> init_storage;
    init_storage -> load_config;
    load_config -> setup_handlers;
    setup_handlers -> user_start;
    
    user_start -> check_user_type;
    check_user_type -> admin_menu [label="ĞĞ´Ğ¼Ğ¸Ğ½Ğ¸ÑÑ‚Ñ€Ğ°Ñ‚Ğ¾Ñ€"];
    check_user_type -> user_menu [label="ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ"];
    
    admin_menu -> admin_actions;
    user_menu -> user_actions;
    
    // ĞœĞ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³
    passive_monitoring -> receive_message;
    active_monitoring -> receive_message;
    userbot_start -> userbot_join;
    userbot_join -> userbot_monitor;
    userbot_monitor -> userbot_process;
    userbot_process -> receive_message;
    
    receive_message -> extract_info;
    extract_info -> check_source;
    check_source -> ai_analysis [label="Ğ˜ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº\nĞ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ‚ÑÑ"];
    check_source -> end [label="Ğ˜ÑÑ‚Ğ¾Ñ‡Ğ½Ğ¸Ğº\nĞ½Ğµ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ‚ÑÑ"];
    
    ai_analysis -> giga_chat;
    giga_chat -> check_importance;
    check_importance -> check_threshold;
    check_threshold -> inline_moderation [label="Ğ’Ğ°Ğ¶Ğ½Ğ¾Ğµ"];
    check_threshold -> end [label="ĞĞµĞ²Ğ°Ğ¶Ğ½Ğ¾Ğµ"];
    
    // ĞœĞ¾Ğ´ĞµÑ€Ğ°Ñ†Ğ¸Ñ
    inline_moderation -> admin_review;
    admin_review -> approve_decision;
    admin_review -> reject_decision;
    
    approve_decision -> auto_publish [label="ĞĞ²Ñ‚Ğ¾Ğ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ\nĞ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ°"];
    approve_decision -> manual_publish [label="Ğ ÑƒÑ‡Ğ½Ğ°Ñ\nĞ¿ÑƒĞ±Ğ»Ğ¸ĞºĞ°Ñ†Ğ¸Ñ"];
    
    auto_publish -> publish_channel;
    manual_publish -> publish_channel;
    
    approve_decision -> notify_user;
    reject_decision -> notify_user;
    
    // Ğ¥Ñ€Ğ°Ğ½Ğ¸Ğ»Ğ¸Ñ‰Ğ°
    init_storage -> user_prefs;
    init_storage -> bot_config;
    init_storage -> pending_posts;
    
    // ĞšĞ¾Ğ½ĞµÑ‡Ğ½Ñ‹Ğµ Ñ‚Ğ¾Ñ‡ĞºĞ¸
    end [label="ğŸ ĞšĞ¾Ğ½ĞµÑ†\nĞ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸", shape=ellipse, fillcolor=lightblue];
    
    // Ğ”Ğ¾Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ ÑĞ²ÑĞ·Ğ¸
    admin_actions -> passive_monitoring [label="ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ°\nĞ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°"];
    admin_actions -> active_monitoring [label="Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ\nUserbot"];
    user_actions -> passive_monitoring [label="ĞŸÑ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ\nĞ¿Ğ¾ÑÑ‚Ğ°"];
    
    // Ğ¡Ñ‚Ğ¸Ğ»Ğ¸ Ğ´Ğ»Ñ Ğ»ÑƒÑ‡ÑˆĞµĞ¹ Ñ‡Ğ¸Ñ‚Ğ°ĞµĞ¼Ğ¾ÑÑ‚Ğ¸
    edge [color=blue, penwidth=2];
    start_bot -> init_storage;
    user_start -> check_user_type;
    receive_message -> extract_info;
    ai_analysis -> giga_chat;
    approve_decision -> auto_publish;
    
    edge [color=red, penwidth=1];
    check_source -> end;
    check_threshold -> end;
    reject_decision -> notify_user;
    
    edge [color=green, penwidth=1];
    approve_decision -> notify_user;
    auto_publish -> publish_channel;
    manual_publish -> publish_channel;
} 