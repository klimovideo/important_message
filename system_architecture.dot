digraph SystemArchitecture {
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥—Ä–∞—Ñ–∞
    rankdir=TB;
    node [shape=box, style=filled, fontname="Arial", fontsize=10];
    edge [fontname="Arial", fontsize=9];
    
    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –≤–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
    subgraph cluster_external {
        label="üåê –í–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã";
        style=filled;
        color=lightgrey;
        
        telegram_users [label="üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏\nTelegram", fillcolor=lightpink];
        telegram_channels [label="üì¢ Telegram\n–∫–∞–Ω–∞–ª—ã", fillcolor=lightpink];
        telegram_chats [label="üí¨ Telegram\n—á–∞—Ç—ã", fillcolor=lightpink];
        giga_chat_api [label="ü§ñ GigaChat\nAPI", fillcolor=lightcoral];
    }
    
    // –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã
    subgraph cluster_core {
        label="üèóÔ∏è –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã";
        style=filled;
        color=lightblue;
        
        main_bot [label="ü§ñ –û—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç\n(python-telegram-bot)", fillcolor=lightgreen];
        userbot [label="üë§ Userbot\n(Pyrogram)", fillcolor=lightgreen];
        ai_service [label="üß† AI —Å–µ—Ä–≤–∏—Å\n(–∞–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏)", fillcolor=lightgreen];
        admin_service [label="üëë –ê–¥–º–∏–Ω —Å–µ—Ä–≤–∏—Å\n(–º–æ–¥–µ—Ä–∞—Ü–∏—è)", fillcolor=lightgreen];
        storage [label="üíæ –•—Ä–∞–Ω–∏–ª–∏—â–µ\n(JSON —Ñ–∞–π–ª—ã)", fillcolor=lightyellow];
    }
    
    // –ú–æ–¥—É–ª–∏ –∏ —Å–µ—Ä–≤–∏—Å—ã
    subgraph cluster_modules {
        label="üîß –ú–æ–¥—É–ª–∏ –∏ —Å–µ—Ä–≤–∏—Å—ã";
        style=filled;
        color=lightgreen;
        
        message_handler [label="üì® –û–±—Ä–∞–±–æ—Ç—á–∏–∫\n—Å–æ–æ–±—â–µ–Ω–∏–π", fillcolor=lightyellow];
        callback_handler [label="üîò –û–±—Ä–∞–±–æ—Ç—á–∏–∫\ncallback", fillcolor=lightyellow];
        config_manager [label="‚öôÔ∏è –ú–µ–Ω–µ–¥–∂–µ—Ä\n–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏", fillcolor=lightyellow];
        notification_service [label="üîî –°–µ—Ä–≤–∏—Å\n—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π", fillcolor=lightyellow];
        moderation_service [label="üìù –°–µ—Ä–≤–∏—Å\n–º–æ–¥–µ—Ä–∞—Ü–∏–∏", fillcolor=lightyellow];
    }
    
    // –•—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö
    subgraph cluster_storage {
        label="üíæ –•—Ä–∞–Ω–∏–ª–∏—â–∞ –¥–∞–Ω–Ω—ã—Ö";
        style=filled;
        color=lightyellow;
        
        user_prefs_db [label="üë• user_preferences.json\n(–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)", fillcolor=orange];
        bot_config_db [label="ü§ñ bot_config.json\n(–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–æ—Ç–∞)", fillcolor=orange];
        pending_posts_db [label="üìù pending_posts.json\n(–æ—á–µ—Ä–µ–¥—å –º–æ–¥–µ—Ä–∞—Ü–∏–∏)", fillcolor=orange];
        userbot_session [label="üë§ userbot_session.session\n(—Å–µ—Å—Å–∏—è userbot)", fillcolor=orange];
    }
    
    // –ö–∞–Ω–∞–ª—ã –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
    subgraph cluster_output {
        label="üì§ –í—ã—Ö–æ–¥–Ω—ã–µ –∫–∞–Ω–∞–ª—ã";
        style=filled;
        color=lightpink;
        
        important_channel [label="üì¢ –ö–∞–Ω–∞–ª –≤–∞–∂–Ω—ã—Ö\n—Å–æ–æ–±—â–µ–Ω–∏–π", fillcolor=lightcoral];
        admin_notifications [label="üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è\n–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º", fillcolor=lightcoral];
        user_notifications [label="üì± –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è\n–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º", fillcolor=lightcoral];
    }
    
    // –°–≤—è–∑–∏ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
    telegram_users -> main_bot [label="–ö–æ–º–∞–Ω–¥—ã\n–∏ —Å–æ–æ–±—â–µ–Ω–∏—è"];
    telegram_channels -> main_bot [label="–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥\n(–µ—Å–ª–∏ –±–æ—Ç –∞–¥–º–∏–Ω)"];
    telegram_channels -> userbot [label="–°–∫—Ä—ã—Ç—ã–π\n–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"];
    telegram_chats -> userbot [label="–°–∫—Ä—ã—Ç—ã–π\n–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥"];
    
    // –°–≤—è–∑–∏ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
    main_bot -> message_handler;
    main_bot -> callback_handler;
    main_bot -> config_manager;
    
    message_handler -> ai_service [label="–ê–Ω–∞–ª–∏–∑\n–≤–∞–∂–Ω–æ—Å—Ç–∏"];
    message_handler -> admin_service [label="–ú–æ–¥–µ—Ä–∞—Ü–∏—è"];
    
    ai_service -> giga_chat_api [label="API –∑–∞–ø—Ä–æ—Å—ã"];
    giga_chat_api -> ai_service [label="–û—Ü–µ–Ω–∫–∞\n–≤–∞–∂–Ω–æ—Å—Ç–∏"];
    
    admin_service -> moderation_service;
    admin_service -> notification_service;
    
    // –°–≤—è–∑–∏ —Å —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º–∏
    storage -> user_prefs_db;
    storage -> bot_config_db;
    storage -> pending_posts_db;
    
    main_bot -> storage [label="–ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å\n–¥–∞–Ω–Ω—ã—Ö"];
    userbot -> storage [label="–ß—Ç–µ–Ω–∏–µ\n–Ω–∞—Å—Ç—Ä–æ–µ–∫"];
    ai_service -> storage [label="–ß—Ç–µ–Ω–∏–µ\n–∫—Ä–∏—Ç–µ—Ä–∏–µ–≤"];
    admin_service -> storage [label="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ\n–ø–æ—Å—Ç–∞–º–∏"];
    
    userbot -> userbot_session [label="–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ\n—Å–µ—Å—Å–∏–∏"];
    
    // –í—ã—Ö–æ–¥–Ω—ã–µ —Å–≤—è–∑–∏
    admin_service -> important_channel [label="–ü—É–±–ª–∏–∫–∞—Ü–∏—è\n–≤–∞–∂–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π"];
    notification_service -> admin_notifications [label="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è\n–∞–¥–º–∏–Ω–∞–º"];
    notification_service -> user_notifications [label="–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è\n–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º"];
    
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–≤—è–∑–∏
    config_manager -> storage [label="–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ\n–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π"];
    moderation_service -> storage [label="–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ\n—Å—Ç–∞—Ç—É—Å–æ–≤"];
    
    // –°—Ç–∏–ª–∏ –¥–ª—è –ª—É—á—à–µ–π —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏
    edge [color=blue, penwidth=2];
    telegram_users -> main_bot;
    ai_service -> giga_chat_api;
    admin_service -> important_channel;
    
    edge [color=green, penwidth=1];
    main_bot -> message_handler;
    message_handler -> ai_service;
    ai_service -> storage;
    
    edge [color=orange, penwidth=1];
    storage -> user_prefs_db;
    storage -> bot_config_db;
    storage -> pending_posts_db;
    
    edge [color=red, penwidth=1];
    telegram_channels -> userbot;
    telegram_chats -> userbot;
    
    // –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —É—Ä–æ–≤–Ω—è–º
    {rank=same; telegram_users; telegram_channels; telegram_chats}
    {rank=same; main_bot; userbot}
    {rank=same; ai_service; admin_service}
    {rank=same; user_prefs_db; bot_config_db; pending_posts_db}
    {rank=same; important_channel; admin_notifications; user_notifications}
} 